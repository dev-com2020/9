<style>
    input.ng-dirty.ng-invalid {
        border: 2px solid red;
    }

    input.ng-dirty.ng-valid {
        border: 2px solid green;
    }
</style>


<ng-template #titleTemplate let-text="title">
    <h4 class="p-2 bg-success text-white">{{text}}</h4>
</ng-template>
<ng-template [ngTemplateOutlet]="titleTemplate" [ngTemplateOutletContext]="{title: 'Nagłówek'}"></ng-template>

<div class="text-white m-2">
    <div class="bg-info p-2">
        Mamy {{getProductCount()}} produktów.
    </div>

    <div class="bg-info p-2">
        
        Wybrany produkt: {{selectedProduct || '(brak)'}}
    </div>

    <table class="table table-sm table-bordered mt-1 text-white">
        <tr>
            <th>ID</th>
            <th>Produkt</th>
            <th>Kategoria</th>
            <th>Cena</th>
        </tr>
        <tr *ngFor="let item of getProducts(); let i = index; let odd = odd; 
    let first = first; let last = last; pa-attr" class="text-white" [class.bg-primary]="odd"
            [class.bg-info]="!odd" [class.bg-warning]="first || last" [class.bg-warning]="getSelected(item)">
            <td (mouseover)="selectedProduct=item.name">{{i + 1}}</td>
            <td>{{item.name}}</td>
            <td>{{item.category}}</td>
            <td>{{item.price}}</td>

        </tr>
    </table>

    <form class="m-2" novalidate [formGroup]="formGroup" (ngSubmit)="submitForm()">
        <div class="bg-danger" *ngIf="formSubmitted && formGroup.invalid">
            Wystąpiły problemy z formularzem!
            <ul>
            <li *ngFor="let error of formGroup.getFormValidationMessages()">
                {{error}}
                </li>
                </ul>
                               
        </div>

        <div class="form-group" *ngFor="let control of formGroup.productControls">
            <label>{{control.label}}</label>
            <input class="form-control" name="{{control.modelProperty}}" formControlName="{{control.modelProperty}}">
            <ul class="text-danger list-unstyled"
                *ngIf="(formSubmitted || control.dirty) && control.invalid">
               
                    <li *ngFor="let error of control.getValidationMessages()">
                        {{error}}
                    </li>
                </ul>
        </div>
                
                <button class="btn btn-primary" type="submit" [disabled]="formSubmitted && formGroup.invalid"
                    [class.btn-secondary]="formSubmitted && formGroup.invalid">Dodaj</button>
    
    </form>

    <ng-template [ngTemplateOutlet]="titleTemplate" [ngTemplateOutletContext]="{title: 'Stopka'}"></ng-template>


    <div class="bg-info p-2">
        Cena po zaokrągleniu wynosi {{getProductPrice(2)}}zł.
    </div>

</div>